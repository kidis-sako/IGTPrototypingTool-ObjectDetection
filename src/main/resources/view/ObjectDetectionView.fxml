<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.*?>

<ScrollPane fitToHeight="true" fitToWidth="true" xmlns="http://javafx.com/javafx/17" 
            xmlns:fx="http://javafx.com/fxml/1" 
            fx:controller="controller.ObjectDetectionController">
    
    <HBox spacing="20" alignment="TOP_CENTER" style="-fx-padding: 20;">
        
        <!-- Left Panel: Images -->
        <VBox spacing="15" alignment="TOP_CENTER" prefWidth="700">
            
            <!-- Original Image -->
            <TitledPane text="Original Image" collapsible="false" prefWidth="680">
                <VBox alignment="CENTER" spacing="10">
                    <ImageView fx:id="originalImageView" fitWidth="640" fitHeight="480" 
                               preserveRatio="true" 
                               style="-fx-border-color: #cccccc; -fx-border-width: 2;"/>
                    <HBox spacing="10" alignment="CENTER">
                        <Button text="Load Current Frame" onAction="#loadCurrentFrame" 
                                style="-fx-font-size: 12px;"/>
                        <Button text="Load Test Frame" onAction="#loadTestFrame" 
                                style="-fx-font-size: 12px;"/>
                    </HBox>
                </VBox>
            </TitledPane>
            
            <!-- Detection Result Image -->
            <TitledPane text="Detection Result" collapsible="false" prefWidth="680">
                <VBox alignment="CENTER">
                    <ImageView fx:id="detectionImageView" fitWidth="640" fitHeight="480" 
                               preserveRatio="true"
                               style="-fx-border-color: #cccccc; -fx-border-width: 2;"/>
                </VBox>
            </TitledPane>
            
        </VBox>
        
        <!-- Right Panel: Controls -->
        <VBox spacing="15" prefWidth="400">
            
            <!-- Detection Method Selection -->
            <TitledPane text="Detection Method" collapsible="false">
                <VBox spacing="10" style="-fx-padding: 10;">
                    <Label text="Select Algorithm:" style="-fx-font-weight: bold;"/>
                    <ComboBox fx:id="detectionMethodCombo" prefWidth="350"/>
                    <Separator/>
                    <CheckBox fx:id="visualizeCheckBox" text="Show Visualization" 
                              selected="true" style="-fx-font-size: 12px;"/>
                    <Button fx:id="detectButton" text="Run Detection" 
                            onAction="#handleDetect" prefWidth="350"
                            style="-fx-font-size: 14px; -fx-font-weight: bold;"/>
                </VBox>
            </TitledPane>
            
            <!-- Parameters Panel -->
            <TitledPane fx:id="parametersPanel" text="Detection Parameters" collapsible="true">
                <VBox spacing="15" style="-fx-padding: 10;">
                    
                    <!-- Edge Detection Parameters -->
                    <VBox spacing="8">
                        <Label fx:id="cannyLabel" text="Edge Detection (Canny)" style="-fx-font-weight: bold; -fx-font-size: 12px;"/>
                        <HBox spacing="10" alignment="CENTER_LEFT">
                            <Label text="Lower Threshold:" prefWidth="120"/>
                            <Slider fx:id="cannyThreshold1Slider" min="10" max="100" value="30" 
                                    prefWidth="150" showTickLabels="false" showTickMarks="true"/>
                            <Label fx:id="cannyThreshold1Label" text="30" prefWidth="40" 
                                   style="-fx-font-weight: bold;"/>
                        </HBox>
                        <HBox spacing="10" alignment="CENTER_LEFT">
                            <Label text="Upper Threshold:" prefWidth="120"/>
                            <Slider fx:id="cannyThreshold2Slider" min="30" max="200" value="90" 
                                    prefWidth="150" showTickLabels="false" showTickMarks="true"/>
                            <Label fx:id="cannyThreshold2Label" text="90" prefWidth="40" 
                                   style="-fx-font-weight: bold;"/>
                        </HBox>
                        <Button fx:id="autoThresholdsButton" text="Auto-Calculate Thresholds" onAction="#autoCalculateThresholds"
                                style="-fx-font-size: 11px;" prefWidth="260"/>
                    </VBox>
                    
                    <Separator/>
                    
                    <!-- Line Detection Parameters -->
                    <VBox spacing="8">
                        <Label fx:id="houghLabel" text="Line Detection (Hough)" style="-fx-font-weight: bold; -fx-font-size: 12px;"/>
                        <HBox spacing="10" alignment="CENTER_LEFT">
                            <Label text="Hough Threshold:" prefWidth="120"/>
                            <Slider fx:id="houghThresholdSlider" min="20" max="200" value="100" 
                                    prefWidth="150" showTickLabels="false" showTickMarks="true"/>
                            <Label fx:id="houghThresholdLabel" text="100" prefWidth="40" 
                                   style="-fx-font-weight: bold;"/>
                        </HBox>
                    </VBox>
                    
                    <Separator/>
                    
                    <!-- Circle Detection Parameters -->
                    <VBox spacing="8">
                        <Label fx:id="circleLabel" text="Circle Detection" style="-fx-font-weight: bold; -fx-font-size: 12px;"/>
                        <HBox spacing="10" alignment="CENTER_LEFT">
                            <Label text="Min Radius:" prefWidth="120"/>
                            <Slider fx:id="minRadiusSlider" min="5" max="100" value="10" 
                                    prefWidth="150" showTickLabels="false" showTickMarks="true"/>
                            <Label fx:id="minRadiusLabel" text="10" prefWidth="40" 
                                   style="-fx-font-weight: bold;"/>
                        </HBox>
                        <HBox spacing="10" alignment="CENTER_LEFT">
                            <Label text="Max Radius:" prefWidth="120"/>
                            <Slider fx:id="maxRadiusSlider" min="50" max="400" value="200" 
                                    prefWidth="150" showTickLabels="false" showTickMarks="true"/>
                            <Label fx:id="maxRadiusLabel" text="200" prefWidth="40" 
                                   style="-fx-font-weight: bold;"/>
                        </HBox>
                    </VBox>
                    
                    <Separator/>
                    
                    <!-- Interface Detection Parameters -->
                    <VBox spacing="8">
                        <Label fx:id="interfaceLabel" text="Interface Detection" style="-fx-font-weight: bold; -fx-font-size: 12px;"/>
                        <HBox spacing="10" alignment="CENTER_LEFT">
                            <Label text="Peak Height Ratio:" prefWidth="120"/>
                            <Slider fx:id="peakHeightRatioSlider" min="0.05" max="0.5" value="0.15" 
                                    prefWidth="150" showTickLabels="false" showTickMarks="true"/>
                            <Label fx:id="peakHeightRatioLabel" text="0.15" prefWidth="40" 
                                   style="-fx-font-weight: bold;"/>
                        </HBox>
                    </VBox>
                    
                </VBox>
            </TitledPane>
            
            <!-- Results Display -->
            <TitledPane text="Detection Results" collapsible="false">
                <VBox style="-fx-padding: 5;">
                    <TextArea fx:id="resultsTextArea" prefHeight="300" 
                              editable="false" wrapText="true"
                              style="-fx-font-family: 'Courier New'; -fx-font-size: 11px;"/>
                </VBox>
            </TitledPane>
            
        </VBox>
        
    </HBox>
    
</ScrollPane>

